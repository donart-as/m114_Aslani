# Tag 6 03.10.2025

## 1. Diffie-Hellman (DH)

- **Zweck:** Schlüssel austauschen über unsichere Leitung  
- **Idee (Farben-Analogie):**
  - Öffentliche Basisfarbe (Gelb)
  - Alice mischt mit Geheimfarbe → Beige  
  - Bob mischt mit Geheimfarbe → Graublau  
  - Beide mischen nochmals → gleiche Endfarbe (geheimer Schlüssel)

- **Formeln:**
  - Öffentliche Werte: p (Primzahl), g (Basis)  
  - Alice: a (geheim), A = gᵃ mod p  
  - Bob: b (geheim), B = gᵇ mod p  
  - Gemeinsamer Schlüssel:  
    - S = Bᵃ mod p = Aᵇ mod p

- **Sicherheit:** Diskreter Logarithmus schwer zu berechnen → sicher bei großen p (z. B. 2048 Bit)

### Aufgabe 1
- Beispiel: p=23, g=5  
  - Alice: a=6 → A=5⁶ mod 23 = 8  
  - Bob: b=15 → B=5¹⁵ mod 23 = 2  
  - Schlüssel:  
    - Alice: 2⁶ mod 23 = 18  
    - Bob: 8¹⁵ mod 23 = 18  
  - ✔ gemeinsamer Schlüssel = **18**

---

## 2. RSA

- **Zweck:** Nachrichten verschlüsseln und Signaturen erstellen  
- **Idee:** Faktorisierung schwer (N = p·q)  
- **Formeln:**  
  - N = p·q  
  - φ = (p-1)(q-1)  
  - Wähle e (öffentlich)  
  - Berechne d (privat)  
  - Verschlüsselung: c = kᵉ mod N  
  - Entschlüsselung: k = cᵈ mod N

### Aufgabe 2
- Beispiel: p=11, q=29  
  - N=319, φ=280  
  - e=17, d=33  
  - Klartext "A" = 65  
  - Verschlüsselt: 65¹⁷ mod 319 = 285  
  - Entschlüsselt: 285³³ mod 319 = 65 → "A" ✔  

- Ergebnis: Nur der **richtige Private Key** kann die Nachricht entschlüsseln.  
- RSA arbeitet blockweise → Text wird in Blöcke zerlegt.

---

## 3. Hybride Verfahren

- **Problem:**  
  - Symmetrisch: schnell, aber Schlüssel muss geteilt werden  
  - Asymmetrisch: sicherer Schlüsseltausch, aber langsam  

- **Lösung:** Kombination → Hybrid  
  - Session-Key wird mit RSA (asymmetrisch) verschlüsselt  
  - Nachricht mit AES (symmetrisch) verschlüsselt  

- **Beispiele:** TLS (HTTPS), PGP, S/MIME, IPsec  

### Aufgabe 3
- Datei verschlüsselt mit RSA-AES:  
  - Hex-Datei zeigt zuerst den RSA-verschlüsselten **Session-Key**  
  - Danach die AES-verschlüsselten Daten  
- Session-Key-Länge: meist 128 oder 256 Bit  
- Echtheit: Über Zertifikat prüfbar (PKI)

---

# Wichtig merken
- **DH:** Schlüsseltausch, kein Verschlüsseln von Nachrichten  
- **RSA:** Nachrichten und Signaturen  
- **Hybrid:** RSA für Schlüssel, AES für Daten  
- **PKI:** Verwaltung von Zertifikaten und Schlüsseln
